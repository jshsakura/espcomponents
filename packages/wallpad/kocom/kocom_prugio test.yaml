switch:
# 일괄소등 토글 스위치 - 일괄소등 ↔ 이전 상태 복원
  - platform: template
    name: "All Lights Control"
    icon: "mdi:lightbulb-group"
    optimistic: true
    restore_mode: DISABLED
    turn_on_action:
      # 이전 상태 복원 (일괄소등 해제) - 월패드가 기억하는 이전 상태로만 복원
      - logger.log: "일괄소등 해제 - 이전 상태로 복원 중..."
      # 패턴 1: 기본 일괄소등 해제 (0x3B 디바이스) - 복원 명령만
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 500ms
      # 패턴 2: 월패드 복원 제어 (0x01 디바이스) - 복원 명령
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x3b, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - logger.log: "일괄소등 해제 완료 - 이전 조명 상태로 복원되었습니다"
    turn_off_action:
      # 일괄소등 실행 (모든 조명 끄기)
      - logger.log: "일괄소등 실행 중..."
      # 패턴 1: 기본 일괄소등 (0x3B 디바이스)
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 500ms
      # 패턴 2: 전체 조명 제어 (0x0E 디바이스, Room FF)
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 500ms
      # 패턴 3: 월패드 제어 (0x01 디바이스)
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - logger.log: "일괄소등 완료 - 모든 조명이 꺼졌습니다"

button:
# 🔍 고급 스캔 기능 - 모든 디바이스 탐지
  - platform: template
    name: "Advanced Device Scanner"
    icon: "mdi:radar"
    on_press:
      # 조명 스캔 (Room 0-10까지 확장)
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x01, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x03, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x04, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x05, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x06, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x07, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x08, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x09, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x0e, 0x0a, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      # 환기팬 스캔 (Room 0-10까지)
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x01, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x03, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x04, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x05, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x06, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      # 난방 스캔 (Room 0-10까지)
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x01, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x02, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x03, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x04, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x36, 0x05, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      # 일괄소등 및 기타 기능 스캔
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x01, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x3b, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      # 🌪️ 환풍기/환기팬 전용 스캔 (다양한 패턴)
      - delay: 300ms
      - logger.log: "=== 환풍기/환기팬 전용 스캔 시작 ==="
      - logger.log: "🔍 Room 0-6까지 0x48 디바이스 스캔 중..."

      # 패턴 1: 기본 환기팬 스캔 (0x48 디바이스)
      - logger.log: "📍 Room 0 (거실 전체 환풍기) 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x00, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 1 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x01, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 2 (안방화장실 환기팬) 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x02, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 3 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x03, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 4 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x04, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 5 (거실화장실 환기팬) 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x05, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - logger.log: "📍 Room 6 스캔 중..."
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x06, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]

      # 패턴 2: 환기팬 상태 조회 (0x48 디바이스, 다른 명령)
      - delay: 200ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x05, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x48, 0x02, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]

      # 패턴 3: 다른 환기 관련 디바이스 스캔 (0x47, 0x49 등)
      - delay: 200ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x47, 0x05, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
      - delay: 200ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x49, 0x05, 0x01, 0x00, 0x00, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]

      - logger.log: "=== 환풍기/환기팬 전용 스캔 완료 ==="

      # 엘리베이터 상태 스캔
      - delay: 300ms
      - uartex.write:
          data: [0x30, 0xbc, 0x00, 0x44, 0x00, 0x01, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]
          ack: [0x30, 0xdc]
